<!DOCTYPE html>
<html>
<head>
    <title>COBOL Structure Viewer</title>
    <link href="https://unpkg.com/tabulator-tables/dist/css/tabulator.min.css" rel="stylesheet">
    <script src="https://unpkg.com/tabulator-tables/dist/js/tabulator.min.js"></script>
    <style>
        body { font-family: sans-serif; padding: 20px; }
        textarea { width: 100%; height: 150px; margin-bottom: 10px; }
        #example-table { margin-top: 20px; }
    </style>
</head>
<body>
    <h2>COBOL Copybook 解析器</h2>
    <textarea id="cobolInput" placeholder="在此貼上 COBOL Copybook 代碼..."></textarea>
    <br>
    <button onclick="parseCobol()">解析並顯示結構</button>

    <div id="example-table"></div>

    <script>
        var table = new Tabulator("#example-table", {
            height: "400px",
            layout: "fitColumns",
            columns: [
                {title: "Level", field: "level", width: 80},
                {title: "Field Name", field: "name", width: 250},
                {title: "Position", field: "position", hozAlign: "right"},
                {title: "Length", field: "length", hozAlign: "right"},
                {title: "Picture", field: "picture"}
            ],
        });

        function parseCobol() {
            var content = document.getElementById("cobolInput").value;
            fetch('/api/parse-grid', {
                method: 'POST',
                headers: { 'Content-Type': 'text/plain' },
                body: content
            })
            .then(response => response.json())
            .then(data => {
                table.setData(data);
            });
        }
    </script>
</body>
</html>